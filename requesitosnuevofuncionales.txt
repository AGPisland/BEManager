Nuevo modelo de datos.

CLIENTES (ID_CLIENTE, NOMBRE_CLIENTE, RUT_CLIENTE, INFORMACION{})

DEVICES (ID_DEVICE, NOMBRE_DEVICE, CHIP_DEVICE, INFORMACION{})

APISCLIS (ID_API, ID_CLIENTE, ID_DEVICE, ESTADO_API, PERMISOS_API, INFORMACION{KEY, USER, MAIL, TOKEN})

MQTTDEVS (ID_MQTTKEY, ID_DEVICE, ESTADO_MQTT, PERMISOS_MQTT, INFORMACION(KEY, USER, SERVER, PORT, TOPIC, URL_CLOUD))

REGISTROS (ID_REGISTRO, ID_MQTTKEY, METADATA{BATERIA, CONTADOR}, DATASEN{SENSORV1, SENSORV2})

FALLOS (ID_FALLO, ID_DEVICE, ID_CLIENTE, INFORMACION{FALLO1, FALLO2} )

USERS (ID_USER, NOMBRE, APELLIDO, RUN, USERNAME, PASSWORD, ADMIN, ACTIVO)




     CLIENTE>---1--n--->APISCLI
                         ^
                         |          
     DEVICE>----1--n-----|
        |
        |-------1--1---->MQTTDEVS---1--m--->REGISTROS    


FUNCIONALIDADES SOBRE LA BASE DE DATOS 

CLIENTES,
    INSERT NOMBRE_CLIENTE, NOMBRE_REPRESENTANTE, JSON_SOBRE_CLIENTE
    UPDATE NOMBRE_CLIENTE, NOMBRE_REPRESENTANTE, JSON_SOBRE_CLIENTE
    SELECT NOMBRE_CLIENTE, NOMBRE_REPRESENTANTE, JSON_SOBRE_CLIENTE ORDER BY FECHA_CREACION

DEVICES,
    INSERT JSON_INFO_DEVICE, NOMBRE_AUTOR, NOMBRE_DEVICE *EL ID DEBE SER INGRESADO POR EL USUARIO
    UPDATE JSON_INFO_DEVICE, NOMBRE_AUTOR, NOMBRE_DEVICE
    SELECT JSON_INFO_DEVICE, NOMBRE_AUTOR, NOMBRE_DEVICE ORDER BY FECHA_CREACION

APISCLIS,
    INSERT (SELECT ID_CLIENTE FROM CLIENTES WHERE NOMBRE_CLIENTE="NOMBRE"), (SELECT ID_DEVICE 
        FROM DEVICES WHERE NOMBRE_DEVICE="NOMBRE_D"), ESTADO_API, PERMISOS_API, INFORMACION_API.
    UPDATE ESTADO_API, PERMISOS_API, INFORMACION_API
    DELETE ID_CLIENTE, ID_DEVICE
    SELECT ID_API, (SELECT NOMBRE_CLIENTE FROM CLIENTES WHERE ID_CLIENTE="ID_CLIENTE"), 
        (SELECT NOMBRE_DEVICE FROM DEVICES WHERE ID_DEVICE="ID_DEVICE"), ESTADO_API, PERMISOS_API,
        INFORMACION_API.

MQTTDEVS,
    INSERT (SELECT ID_DEVICES FROM DEVICES WHERE NOMBRE_DEVICE = "NOMBRE_D"), ESTADO_MQTT, PERMISOS_MQTT,
        INFORMACION(BROKER).
    UPDATE ESTADO_MQTT, PERMISOS_MQTT, INFORMACION(BROKER)
    DELETE ID_MQTTKEY
    SELECT ID_MQTTKEY, (SELECT NOMBRE_DEVICE FROM DEVICES WHERE ID_DEVICE="ID_DEVICE"), ESTADO_MQTT,
        PERMISOS_MQTT, INFORMACION(BROKE).

FALLOS
    INSERT (SELECT ID_DEVICES FROM DEVICES WHERE NOMBRE_DEVICE = "NOMBRE_D"), (SELECT ID_CLIENTE
        FROM CLIENTES WHERE NOMBRE_CLIENTE="NOMBRE"), INFORMACION{FALLO1, FALLO2}


    
